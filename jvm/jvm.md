## 运行时内存区域

### 线程私有

1. 虚拟机栈
   
   1. 与线程同步创建。
   
   2. 每条线程都有自己的一个虚拟机栈。
   
   3. 存储局部变量表与一些尚未算好的结果。
   
   4. 每个方法在执行时候就会创建一个栈帧。
   
   5. 出现的异常
   
   6. 局部变量表
   
   7. 栈帧
   
      存储数据和部分过程的数据结构。用来处理动态连接，方法返回值和异常分派。
   
      随着方法调用而创建，随着方法的结束而销毁。每个栈帧都有自己的本地变量表，操作数栈，和指向当前方法所属的类的运行时常量池的引用。
   
      本地变量表和操作数栈的容量在编译器就指定。
   
      不可能在一个栈帧中引入另一个现场哼的栈帧。
   
   8. 用于存储栈帧。
   
   9. 局部变量表
   
      1. Java虚拟机使用哦局部变量表来实现方法调用的时候的参数传递。
   
   10. 操作数栈
   
       1. 操作数栈的最大深度由编译器决定。
   
2. pc 寄存器（程序计数器）
   1. 保存java虚拟机正在执行的字节码指令的地址。
   2. 如果执行的是native方法那么pc寄存器的值是undefined。

3. 本地方法栈

   1. 类似于虚拟机栈。

### 线程共享

1. 堆

   1. 在虚拟机启动的时候就创建。
   2. 提供所有的类实例和数组对象的分配的区域。
   3. 存储了被gc管理的对象的各种对象。
   4. 内存回收算法。
   5. 堆内的区域划分（垃圾回收角度，内存回收的角度）。

2. 方法区

   1. 存储类似于传统的语言中的编译代码存储区或者系统进程的正文段。存储了每一个类的结构信息。例如，运行时常量池，字段和方法数据，构造函数和普通方法的字节码内容。还包括一些再类实例接口初始化用到的特殊方法。

   2. 运行时常量池：都是在方法区中分配。在加载类到虚拟机后创建。

      是class文件中每一个类或接口的常量池表的运行时表现形式，包括了若干种不不同的常量，从编译期可知的数值字面量到必须在运行时解析后才能获得的方法和字段的引用。

## 内存回收法

### 四种引用

1. 弱引用
2. 软引用
3. 虚引用
4. 强引用

调试参数

```java
-Xms20M -Xmx20M -Xmn10M -XX:+PrintGCDetails -XX:SurvivorRatio=8
```





