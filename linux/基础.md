# linux基础操作

在关机前使用sync指令来将内存的数据存入磁盘。

logout 退出远程连接减轻服务器压力

## 用户操作

useradd -d 

passwd 'username

passwd username 给用户指定密码或创建密码

删除用户：

1. 保留家目录  userdel
2. 同时删除家目录  userdel -r
3. 一般来说保留家目录
4. 默认放在同名组下。
5. 放在指定的组下： useradd -g 用户组 用户名

查询用户信息

1. id 用户名

切换用户

1. su
2. exit 返回到原来的用户
3. whoami查看当前用户

组

1. groudadd
2. groupdel
3. usermod -g 组名 用户名

用户与组的相关文件：

1. /etc/passwd(用户信息)

2. /etc/group(组信息)
3. /etc/shadow(加密的密码信息)

使用指令：

运行级别：

1. 0：关机

   1：单用户

   2： 多用户无网络服务

   3： 多用户有网络服务

   4：保留

   5： 图形界面

   6： 重启

2. etc/inttab (没有被启用)

3. 切换运行级别

   1. init[0123456]

4. 用运行级别找回密码

   1. 如何找回root密码？
      1. 进入单用户模式（root不需要密码就可以登陆）
      2. 在进入到系统启动之前就进行启动前设置
      3. 在引导时按回车键
      4. 。。。

5. 编辑etc/inittab这个文件可以设置默认运行级别。



帮助指令：

1. man

## 文件目录类的指令：

1. pwd 显示当前工作目录的绝对路径。
2. ls以点打头的文件是隐藏文件
3. cd 命令
   1. ~回到家目录
   2. cd../../xxx
   3. cd.. 返回上级路径
4. 创建文件相关的指令：
   1. mkdir -p(创建多级目录)
   2. rmdir (删除一个空的文件夹) rm-rf(删除一个非空目录)
   3. touch 创建一个空文件
   4. cp(拷贝)
      1.  -r递归拷贝
      2. \cp强制覆盖Name
   5. rm -r(删除整个文件夹)-f(强制删除不提示)
   6. mv 移动文件或者重命名
      1. mv oldFileName newFileName
   7. cat 查看文件
   8. more指令按页显示
   9. lees指令分屏查看文件（按页打开，对于显示大型文件）
   10. \>指令\>\>指令输出重定向和追加。
       1. \>:会将原来的内容覆盖
       2. more  文件名+>将文件内容赋值到某个文件
   11. echo 输出内容到控制台。（输出环境变量）echo $PATH
   12. head 指令（显示文件的开头部分）
   13. tail指令输出文件尾部内容
       1. -n行数
       2. -f实时追踪文档的更新 q^H^H^c退出
   14. in 软连接（快捷方式）in -s 创建软连接 cd 软链接名
   15. 删除in软连接 rm -rf按照连接的类型
   16. 用pwd查看通过软连接的目录查看到的依然是软连接的地址。
   17. history 
   18. ！加编号执行编号的指令

## 时间日期类的指令

1. date显示当前日期和时间data"+%Y,M,D"
2. 设置日期 data -s "2018-10-10 11:22:22"
3. cal 查看日历 cal 2020 显示一年的日历

## 搜索查找

1. find指令 查找范围 +【选项】 +文件名（可以带通配符）
   1. -name 按文件名查找
   2. -user 按照文件拥有者去查找
   3. -size查找整个linux系统下大于20M的文件 ls-lh ctrl +c 能够终止查找过
   4. 支持通配符*.txt
2. locate指令(aliyun下没有这个指令)
   1. 利用数据库快速查找
   2. updatedb

1. grep指令和管道符号|
   1. |管道符号表示将前面的指令处理的结果传递给后一个指令
   2. grep过滤查找 
      1. -能显示行号
      2. 无视大小写

## 压缩和解压缩

1. gzip/gunzip
   1. 前者压缩后者解压缩 *.gz
   2. 压缩完后原文件被删除
2. zip/unzip
   1. *zip
   2. 压缩 zip文件名 +文件的地址
   3. -d指定路径 -r递归压缩
3. tar
   1. 既可以压缩也可以解压
   2. *.tar.gz
   3.  tar -zcvf a.tar.gz a1.txt a2.txt
   4. 将所有的文件打包: tar -zvcf myhom.tar /home/
   5. 将a.tar.gz解压到当前目录-zxvf 
   6. 将文件解压到 指定文件夹下 tar -zxvf myhome.tar.gz -C /ofd/..解压到的文件目录必须要存在

## 组管理权限管理

1. ls -ahl查看文件所有者 （显示所有所属当前用户的文件和目录）

2. chown改变文件所有者

3. 文件所在组不一定是所有者所在组

4. chgrp修改文件所在组

5. 改变用户的所在组usermod -g 组名 用户名

6. id username 查看用户信息 

7. chmod命令：

   1. 用+-赋予减去权限（rwx）
   2. 用u（所有者），g(所在组),a(所有人u+g+o)o(其他人)

   abc文件的所有者读写执行权限，给所在组读权限chmod u=wxr abc

8. 

   修改文件的所有者 chown

   修改一个文件下所有文件的所有者-r（要使用root用户来完成）

   修改文件所在组chgrp

9. 权限实践

## 定时任务调度

mysql数据库备份

crontab

任务：

1. 设置任务调度文件：/etc/crontab 

2. 设置个人任务调度：crontab -e

3. 接着输入任务到调度文件中

4. ```java
   */1*******ls -l /etc/>tmp/to.txt
   ```

5. 如果只是简单的任务直接在crontab中加入任务即可

6. 占位符\*已经特殊符号

任务调度的应用实例：

案例一：每隔1分钟就将当前的日期信息，追加到/tmp/mydate文件中 

1. 编写一个文件 mytask.sh

    date >> /tmp/mydate

2. 给mytask.sh 一个可执行权限

3. crontab -e

4. ```java
   *\1 * * * *  /home/task1.sh
   ```

5. 完

案例二：每隔一分钟就将当前的日期和日历都追加到/home/mycal文件中

案例三：每天凌晨两点将mysql数据库testdb,备份到文件中。

```shell
/usr/local/mysqldump -u root -p root testdb > /tmp/mydb.bak
```

crontab -r :终止任务调度

crontab -l：列出所有的任务

crontab：  service crond restart 重启任务调度



## linux磁盘分区与挂载

### 分区的方式

1. mbr分区

   最多只支持四个主分区

   系统只能安装在主分区

   扩展分区要占一个主分区

   mbr最大只支持2tb，但拥有最好的兼容性

2. gtp分区

   支持无限多个主分区（但操作系统限制）

   支持18eb的容量

   Windows7 64位后支持gtp

3. 在linux中的硬盘：(查看系统的分区和挂载情况：lsblk)

   1. 分为ide硬盘，和SCSI影片
   2. ide: hda3 a为盘符 3为分区
   
4. 如何增加一块硬盘？

   1. 添加硬盘
   2. 分区（fidisk /dev/sdb）
   3. 格式化 mkfs -t text4 /dev/sdb
   4. 挂载mount /dev/sdb1 /home/f（重启后失效）
   5. 设置可以自动挂载（/etc/fstb）mout -a
   6. 卸载磁盘：unmount 
   7. 如果卸载磁盘正在使用就会报错

### 磁盘系统整体的磁盘的使用情况

磁盘情况查询

1. 查询系统整体磁盘使用情况 df  -l

2. 查看某个目录占用磁盘的情况du -h 深度

3. 统计/home文件夹下文件的个数

   ```java
   ls -lR(递归统计) /home |grep "^-"| wc -l
   ```

4. 以树状形式显示文件结构 

   ```java
   yum install tree
   tree
   ```

## linux的网络配置

虚拟机的虚拟网卡（windows下就会有两个ip地址一个是虚拟网卡）

网络模式

虚拟网络编辑器

查看网关

linux网络环境配置

1. 自动连接（自动获取）每次的ip地址不同不适用于做服务器。

2. 指定固定的ip地址（修改文件来指定ip，并可以连接到外网）

   （cd /etc/sysconfig/network-scripts/ifcfg-tho(etho网卡的配置）

3. 重启网络服务service network restart



## 进程管理

显示系统的进程信息 ps (tty 使用的终端？终端隐藏，s代表休眠，) 进程执行时的命令行

ps -aux | grep  过滤

ps -aux |grep sshd

查看父进程 ps- ef

查看sshd 的父进程号  ：ps -aux | grep sshd

### 终止进程

kill  进程号

killall 进程名

踢出非法登陆用户

1. 使用ps  -aux |grep shhd查出非法用户的进程号
2. 使用kill进程号杀死用户
3. 终止远程登陆服务（kill (查到的额sshd的端口号)

killall 名称（杀死父进程下的所有子进程）

强制杀掉一个终端（kill -9 进程号）

pstree(以树状的形式来显示进程信息)

pstree -p（将进程id也显示出来）

pstree -u(将用户id显示出来)

## linux服务管理







